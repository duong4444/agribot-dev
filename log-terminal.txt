api:dev: user_prompt:  MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬
api:dev: direct Ä‘áº¿n Orchest Ä‘á»ƒ xá»­ lÃ½
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [AIOrchestrator] Processing query: "MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬" for user b5a0dfd6-579c-4a90-833d-f4145e03c292
api:dev: STEP1 trong orchest==========INTENT CLASSIFIER & NER ==================
api:dev: user_query || prompt:  MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬
api:dev: normalize_prompt_text:  mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬
api:dev: post Ä‘áº¿n 8000/analyze..........................................
api:dev: INTENT tráº£ vá» tá»« 8000/analyze:  knowledge_query
api:dev: entities tráº£ vá» tá»« 8000/analyze:  [
api:dev:   {
api:dev:     type: 'crop_name',
api:dev:     value: 'cÃ  phÃª',
api:dev:     raw: 'cÃ  phÃª',
api:dev:     confidence: 0.95,
api:dev:     start: 35,
api:dev:     end: 41
api:dev:   }
api:dev: ]
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [PythonAIClientService] Python AI Analysis: Intent=knowledge_query, Entities=1, Time=142ms
api:dev: pythonResult:  knowledge_query
api:dev: pythonResult_entities_!!!!!!!!!!!!!:  [
api:dev:   {
api:dev:     type: 'crop_name',
api:dev:     value: 'cÃ  phÃª',
api:dev:     raw: 'cÃ  phÃª',
api:dev:     confidence: 0.95,
api:dev:     start: 35,
api:dev:     end: 41
api:dev:   }
api:dev: ]
api:dev: !!!DÃ™NG PYTHON CHO INENT CLASSIFIER!!!
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [IntentClassifierService] Using Python AI Service (PhoBERT) classification
api:dev: intent_convertToIntentType_aka_intent_tráº£_vá»_step1_orchest:  knowledge_query
api:dev: entities_convertToEntity_aka_entities_tráº£_vá»_step1_orchest:  [
api:dev:   {
api:dev:     type: 'crop_name',
api:dev:     value: 'cÃ  phÃª',
api:dev:     raw: 'cÃ  phÃª',
api:dev:     confidence: 0.95,
api:dev:     position: { start: 35, end: 41 }
api:dev:   }
api:dev: ]
api:dev: !!!!intent_result_ai_orchestrator!!!!:  {
api:dev:   intent: 'knowledge_query',
api:dev:   confidence: 0.999561607837677,
api:dev:   entities: [
api:dev:     {
api:dev:       type: 'crop_name',
api:dev:       value: 'cÃ  phÃª',
api:dev:       raw: 'cÃ  phÃª',
api:dev:       confidence: 0.95,
api:dev:       position: [Object]
api:dev:     }
api:dev:   ],
api:dev:   originalQuery: 'MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬',
api:dev:   normalizedQuery: 'mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬'
api:dev: }
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [AIOrchestrator] Intent: knowledge_query, Confidence: 1.00, Entities: 1
api:dev: user plan:  PREMIUM
api:dev: user status:  ACTIVE
api:dev: isPremiumActive:  true
api:dev: ACCESS CHECK trong orchest:  { allowed: true }
api:dev: STEP2 trong orchest=============== UNKNOWN || CHECK <ACTION || KNOWLEDGE>=============
api:dev: intent_category_|->ACTION || KNOWLEDGE<-|_ai_orchestrator:  knowledge
api:dev: ======================KNOWLEDGE_CATEGORY=======================
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [AIOrchestrator] Attempting Layer 1: Exact Match
api:dev: .............................TRY LAYER1_FTS..................................................
api:dev: cháº¡y vÃ o findExactMatch cá»§a exact-match-v2.service do orchestrator gá»i
api:dev: words:  [
api:dev:   'MÆ°a',  'nhiá»u', 'liÃªn',
api:dev:   'tá»¥c',  'trong', 'thá»i',
api:dev:   'gian', 'cÃ ',    'phÃª',
api:dev:   'ra',   'hoa',   'thÃ¬',
api:dev:   'nÃªn',  'lÃ m',   'gÃ¬'
api:dev: ]
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [QueryPreprocessorService] Query cleaned: "MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬" â†’ "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev: keywords:  [
api:dev:   'mÆ°a',  'nhiá»u',
api:dev:   'liÃªn', 'tá»¥c',
api:dev:   'thá»i', 'gian',
api:dev:   'phÃª',  'hoa',
api:dev:   'lÃ m'
api:dev: ]
api:dev: noiseWordCoint:  6
api:dev: hasNoiseWords:  true
api:dev: recommedProcessing:  true
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [QueryPreprocessorService] Query cleaned: "MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬" â†’ "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [QueryPreprocessorService] Query cleaned: "MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬" â†’ "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [ExactMatchV2Service] !!!! Query preprocessed:
api:dev:   Original: "MÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev:   Cleaned: "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev:   Keywords: [mÆ°a, nhiá»u, liÃªn, tá»¥c, thá»i, gian, phÃª, hoa, lÃ m]
api:dev:   Noise words removed: 6
api:dev: option.useFuzzyFallback:  undefined
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [ExactMatchV2Service] Detected crop filter from NER: "cÃ  phÃª"
api:dev: Trying Crop Knowledge FTS...
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] Searching for: "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev: -------------------SEARCH Báº°NG HEADING-----------------------
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Heading search - Query: "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬" â†’ Normalized: "mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬"
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ“ Query words (>2 chars): [mÆ°a, nhiá»u, liÃªn, tá»¥c, trong, thá»i, gian, phÃª, hoa, thÃ¬, nÃªn, lÃ m]
api:dev: ALLCHUNKS LÃ€ CÃC ROW TRONG crop_knowledge_chunks mÃ  cÃ³ loai_cay = |crop_name - NER|
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ“š Found 22 total chunks to analyze
api:dev: topicKey:  CÃ  PhÃª::1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª" â†’ normalized: "1. thÃ´ng tin chung vá» cÃ¢y cÃ  phÃª" â†’ words: [thÃ´ng, tin, chung, cÃ¢y, phÃª]
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ“Š Topic: "1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª" | Score: 20% | Matched: [phÃª] / [thÃ´ng, tin, chung, cÃ¢y, phÃª]
api:dev: topicKey:  CÃ  PhÃª::1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª
api:dev: topicKey:  CÃ  PhÃª::1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª
api:dev: topicKey:  CÃ  PhÃª::2. CÃ¡ch trá»“ng
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "2. CÃ¡ch trá»“ng" â†’ normalized: "2. cÃ¡ch trá»“ng" â†’ words: [cÃ¡ch, trá»“ng]
api:dev: topicKey:  CÃ  PhÃª::2. CÃ¡ch trá»“ng
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "2. CÃ¡ch trá»“ng" â†’ normalized: "2. cÃ¡ch trá»“ng" â†’ words: [cÃ¡ch, trá»“ng]
api:dev: topicKey:  CÃ  PhÃª::2. CÃ¡ch trá»“ng
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "2. CÃ¡ch trá»“ng" â†’ normalized: "2. cÃ¡ch trá»“ng" â†’ words: [cÃ¡ch, trá»“ng]
api:dev: topicKey:  CÃ  PhÃª::2. CÃ¡ch trá»“ng
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "2. CÃ¡ch trá»“ng" â†’ normalized: "2. cÃ¡ch trá»“ng" â†’ words: [cÃ¡ch, trá»“ng]
api:dev: topicKey:  CÃ  PhÃª::3. CÃ¡ch chÄƒm sÃ³c
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "3. CÃ¡ch chÄƒm sÃ³c" â†’ normalized: "3. cÃ¡ch chÄƒm sÃ³c" â†’ words: [cÃ¡ch, chÄƒm, sÃ³c]
api:dev: topicKey:  CÃ  PhÃª::3. CÃ¡ch chÄƒm sÃ³c
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "3. CÃ¡ch chÄƒm sÃ³c" â†’ normalized: "3. cÃ¡ch chÄƒm sÃ³c" â†’ words: [cÃ¡ch, chÄƒm, sÃ³c]
api:dev: topicKey:  CÃ  PhÃª::3. CÃ¡ch chÄƒm sÃ³c
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "3. CÃ¡ch chÄƒm sÃ³c" â†’ normalized: "3. cÃ¡ch chÄƒm sÃ³c" â†’ words: [cÃ¡ch, chÄƒm, sÃ³c]
api:dev: topicKey:  CÃ  PhÃª::3. CÃ¡ch chÄƒm sÃ³c
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "3. CÃ¡ch chÄƒm sÃ³c" â†’ normalized: "3. cÃ¡ch chÄƒm sÃ³c" â†’ words: [cÃ¡ch, chÄƒm, sÃ³c]
api:dev: topicKey:  CÃ  PhÃª::4. CÃ¡ch bÃ³n phÃ¢n
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "4. CÃ¡ch bÃ³n phÃ¢n" â†’ normalized: "4. cÃ¡ch bÃ³n phÃ¢n" â†’ words: [cÃ¡ch, bÃ³n, phÃ¢n]
api:dev: topicKey:  CÃ  PhÃª::4. CÃ¡ch bÃ³n phÃ¢n
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "4. CÃ¡ch bÃ³n phÃ¢n" â†’ normalized: "4. cÃ¡ch bÃ³n phÃ¢n" â†’ words: [cÃ¡ch, bÃ³n, phÃ¢n]
api:dev: topicKey:  CÃ  PhÃª::4. CÃ¡ch bÃ³n phÃ¢n
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "4. CÃ¡ch bÃ³n phÃ¢n" â†’ normalized: "4. cÃ¡ch bÃ³n phÃ¢n" â†’ words: [cÃ¡ch, bÃ³n, phÃ¢n]
api:dev: topicKey:  CÃ  PhÃª::5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ normalized: "5. cÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ words: [cÃ¡ch, phÃ²ng, trá»«, sÃ¢u, háº¡i, chÃ­nh]
api:dev: topicKey:  CÃ  PhÃª::5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ normalized: "5. cÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ words: [cÃ¡ch, phÃ²ng, trá»«, sÃ¢u, háº¡i, chÃ­nh]
api:dev: topicKey:  CÃ  PhÃª::5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ normalized: "5. cÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ words: [cÃ¡ch, phÃ²ng, trá»«, sÃ¢u, háº¡i, chÃ­nh]
api:dev: topicKey:  CÃ  PhÃª::5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ normalized: "5. cÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ words: [cÃ¡ch, phÃ²ng, trá»«, sÃ¢u, háº¡i, chÃ­nh]
api:dev: topicKey:  CÃ  PhÃª::5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "5. CÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ normalized: "5. cÃ¡ch phÃ²ng trá»« sÃ¢u háº¡i chÃ­nh" â†’ words: [cÃ¡ch, phÃ²ng, trá»«, sÃ¢u, háº¡i, chÃ­nh]
api:dev: topicKey:  CÃ  PhÃª::6. Thu hoáº¡ch vÃ  SÆ¡ cháº¿
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "6. Thu hoáº¡ch vÃ  SÆ¡ cháº¿" â†’ normalized: "6. thu hoáº¡ch vÃ  sÆ¡ cháº¿" â†’ words: [thu, hoáº¡ch, cháº¿]
api:dev: topicKey:  CÃ  PhÃª::6. Thu hoáº¡ch vÃ  SÆ¡ cháº¿
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "6. Thu hoáº¡ch vÃ  SÆ¡ cháº¿" â†’ normalized: "6. thu hoáº¡ch vÃ  sÆ¡ cháº¿" â†’ words: [thu, hoáº¡ch, cháº¿]
api:dev: topicKey:  CÃ  PhÃª::6. Thu hoáº¡ch vÃ  SÆ¡ cháº¿
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ğŸ” Analyzing topic: "6. Thu hoáº¡ch vÃ  SÆ¡ cháº¿" â†’ normalized: "6. thu hoáº¡ch vÃ  sÆ¡ cháº¿" â†’ words: [thu, hoáº¡ch, cháº¿]
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] âŒâŒâŒâŒâŒâŒ No main topic match found (no topic with score >= 70%)
api:dev: subTopicMatch:  null
api:dev: ------------kqua tráº£ vá» cá»§a searchByHeadings-------------------:  null
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [CropKnowledgeFTSService] ==================No heading match, falling back to Layer 2 FTS===================
api:dev: ...........................FULL-TEXT SEARCH Tá»šI CHÆ I..................................
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [CropKnowledgeFTSService] ______________Executing FTS: query="mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬", userId=undefined, limit=5, minRank=0.01, cropFilter=cÃ  phÃª
api:dev: ==========================================================
api:dev: ==========results trong FTS!heading:  [
api:dev:   {
api:dev:     chunkId: 'ca_phe_008',
api:dev:     loaiCay: 'CÃ  PhÃª',
api:dev:     chuDeLon: '3. CÃ¡ch chÄƒm sÃ³c',
api:dev:     tieuDeChunk: '3.1. TÆ°á»›i nÆ°á»›c',
api:dev:     noiDung: 'ÄÃ¢y lÃ  ká»¹ thuáº­t quan trá»ng nháº¥t á»Ÿ TÃ¢y NguyÃªn (vÃ¹ng trá»“ng Robusta).\r- MÃ¹a khÃ´: Cáº§n tÆ°á»›i 3-4 Ä‘á»£t, má»—i Ä‘á»£t cÃ¡ch nhau 20-30 ngÃ y. LÆ°á»£ng nÆ°á»›c 400-600 lÃ­t/gá»‘c/láº§n tÆ°á»›i, Ä‘áº£m báº£o Ä‘áº¥t áº©m sÃ¢u 50-70cm.\r- Siáº¿t nÆ°á»›c: Cáº§n má»™t giai Ä‘oáº¡n khÃ´ háº¡n (siáº¿t nÆ°á»›c) 2-3 thÃ¡ng cuá»‘i mÃ¹a khÃ´ Ä‘á»ƒ cÃ¢y phÃ¢n hÃ³a máº§m hoa.\r- TÆ°á»›i ra hoa: Äá»£t tÆ°á»›i Ä‘áº§u tiÃªn sau mÃ¹a khÃ´ (thÆ°á»ng vÃ o thÃ¡ng 1-2) lÃ  quan trá»ng nháº¥t, mang tÃ­nh quyáº¿t Ä‘á»‹nh Ä‘á»ƒ hoa ná»Ÿ Ä‘á»“ng loáº¡t, tá»· lá»‡ Ä‘áº­u quáº£ cao. TÆ°á»›i muá»™n hoáº·c khÃ´ng Ä‘á»§ nÆ°á»›c sáº½ lÃ m hoa ná»Ÿ lÃ¡c Ä‘Ã¡c, hoa chanh (hoa khÃ´ng thá»¥ pháº¥n), nÄƒng suáº¥t giáº£m.',
api:dev:     metadata: {
api:dev:       has_bold: false,
api:dev:       has_list: true,
api:dev:       char_count: 541,
api:dev:       word_count: 113
api:dev:     },
api:dev:     rank: 1.7647059,
api:dev:     headline: '<b>hoa</b> ná»Ÿ Ä‘á»“ng loáº¡t, tá»· lá»‡ Ä‘áº­u quáº£ cao. TÆ°á»›i muá»™n hoáº·c khÃ´ng Ä‘á»§ nÆ°á»›c sáº½ lÃ m <b>hoa</b> ná»Ÿ lÃ¡c Ä‘Ã¡c, <b>hoa</b> chanh (<b>hoa</b> khÃ´ng'
api:dev:   },
api:dev:   {
api:dev:     chunkId: 'ca_phe_007',
api:dev:     loaiCay: 'CÃ  PhÃª',
api:dev:     chuDeLon: '2. CÃ¡ch trá»“ng',
api:dev:     tieuDeChunk: '2.4. Ká»¹ thuáº­t trá»“ng',
api:dev:     noiDung: 'Ráº¡ch bá» tÃºi báº§u (trÃ¡nh lÃ m vá»¡ báº§u). Äáº·t cÃ¢y vÃ o giá»¯a há»‘ sao cho máº·t báº§u ngang báº±ng máº·t Ä‘áº¥t, hÆ°á»›ng lÃ¡ ghÃ©p (náº¿u lÃ  cÃ¢y ghÃ©p) vá» phÃ­a giÃ³ chÃ­nh. Láº¥p Ä‘áº¥t, nÃ©n cháº·t xung quanh gá»‘c. TÆ°á»›i Ä‘áº«m nÆ°á»›c (20-30 lÃ­t/gá»‘c) ngay sau khi trá»“ng. Pháº£i lÃ m bá»“n vÃ  tá»§ gá»‘c báº±ng cá» khÃ´, rÆ¡m ráº¡ (tá»§ cÃ¡ch gá»‘c 10cm). Trá»“ng cÃ¢y che bÃ³ng táº¡m thá»i (vÃ­ dá»¥: chuá»‘i, muá»“ng) ngay sau khi trá»“ng cÃ  phÃª.',
api:dev:     metadata: {
api:dev:       has_bold: false,
api:dev:       has_list: false,
api:dev:       char_count: 366,
api:dev:       word_count: 79
api:dev:     },
api:dev:     rank: 1.7647059,
api:dev:     headline: 'Ráº¡ch bá» tÃºi báº§u (trÃ¡nh lÃ m vá»¡ báº§u). Äáº·t cÃ¢y vÃ o giá»¯a há»‘ sao cho máº·t báº§u ngang báº±ng máº·t Ä‘áº¥t, hÆ°á»›ng lÃ¡ ghÃ©p (náº¿u'
api:dev:   },
api:dev:   {
api:dev:     chunkId: 'ca_phe_001',
api:dev:     loaiCay: 'CÃ  PhÃª',
api:dev:     chuDeLon: '1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª',
api:dev:     tieuDeChunk: '1.1. Nguá»“n gá»‘c vÃ  PhÃ¢n loáº¡i',
api:dev:     noiDung: 'CÃ¢y cÃ  phÃª (TÃªn khoa há»c: Coffea) lÃ  má»™t chi thá»±c váº­t thuá»™c há» Thiáº¿n tháº£o (Rubiaceae). CÃ³ nhiá»u loÃ i, nhÆ°ng hai loÃ i cÃ³ giÃ¡ trá»‹ kinh táº¿ quan trá»ng nháº¥t trÃªn toÃ n cáº§u vÃ  táº¡i Viá»‡t Nam lÃ :\r- CÃ  phÃª Robusta:\r- Nguá»“n gá»‘c: VÃ¹ng cáº­n Sahara, chÃ¢u Phi.\r- Äáº·c Ä‘iá»ƒm: CÃ¢y dáº¡ng bá»¥i hoáº·c cÃ¢y gá»— nhá», lÃ¡ to, rá»… nÃ´ng. HÃ m lÆ°á»£ng caffeine cao (2% - 4%). Háº¡t trÃ²n, nhá».\r- Äáº·c tÃ­nh: Kháº£ nÄƒng khÃ¡ng bá»‡nh (Ä‘áº·c biá»‡t lÃ  gá»‰ sáº¯t) tá»‘t hÆ¡n Arabica, chá»‹u Ä‘Æ°á»£c khÃ­ háº­u nÃ³ng áº©m, yÃªu cáº§u lÆ°á»£ng mÆ°a cao. ThÆ°á»ng Ä‘Æ°á»£c dÃ¹ng cho cÃ  phÃª hÃ²a tan vÃ  phá»‘i trá»™n.\r- CÃ  phÃª Arabica:\r- Nguá»“n gá»‘c: VÃ¹ng cao nguyÃªn TÃ¢y Nam Ethiopia.\r- Äáº·c Ä‘iá»ƒm: CÃ¢y nhá», lÃ¡ nhá» hÆ¡n Robusta. HÃ m lÆ°á»£ng caffeine tháº¥p (1% - 2%). Háº¡t dÃ i, dáº¹t.\r- Äáº·c tÃ­nh: HÆ°Æ¡ng vá»‹ thÆ¡m, phong phÃº, phá»©c táº¡p, cÃ³ vá»‹ chua thanh. YÃªu cáº§u kháº¯t khe vá» sinh thÃ¡i, pháº£i trá»“ng á»Ÿ Ä‘á»™ cao lá»›n, khÃ­ háº­u mÃ¡t máº». Ráº¥t máº«n cáº£m vá»›i bá»‡nh gá»‰ sáº¯t. ÄÃ¢y lÃ  dÃ²ng cÃ  phÃª chÃ­nh cho "cÃ  phÃª Ä‘áº·c sáº£n" (Specialty Coffee). CÃ¡c giá»‘ng phá»• biáº¿n: Catimor, Typica, Bourbon...',
api:dev:     metadata: {
api:dev:       has_bold: false,
api:dev:       has_list: true,
api:dev:       char_count: 988,
api:dev:       word_count: 202
api:dev:     },
api:dev:     rank: 1.7424242,
api:dev:     headline: 'CÃ¢y cÃ  phÃª (TÃªn khoa há»c: Coffea) lÃ  má»™t chi thá»±c váº­t thuá»™c há» Thiáº¿n tháº£o (Rubiaceae). CÃ³ nhiá»u loÃ i, nhÆ°ng hai loÃ i cÃ³ giÃ¡'
api:dev:   },
api:dev:   {
api:dev:     chunkId: 'ca_phe_003',
api:dev:     loaiCay: 'CÃ  PhÃª',
api:dev:     chuDeLon: '1. ThÃ´ng tin chung vá» CÃ¢y CÃ  PhÃª',
api:dev:     tieuDeChunk: '1.3. YÃªu cáº§u Sinh thÃ¡i (KhÃ­ háº­u & Äáº¥t)',
api:dev:     noiDung: '- CÃ  phÃª Robusta:\r- Äá»™ cao: ThÃ­ch há»£p á»Ÿ Ä‘á»™ cao dÆ°á»›i 1000m (phá»• biáº¿n 500-800m).\r- Nhiá»‡t Ä‘á»™: Æ¯a khÃ­ háº­u nÃ³ng áº©m, nhiá»‡t Ä‘á»™ trung bÃ¬nh 22-26Â°C.\r- LÆ°á»£ng mÆ°a: Cáº§n 1.500 - 2.500 mm/nÄƒm, vÃ  Ä‘áº·c biá»‡t cáº§n má»™t mÃ¹a khÃ´ rÃµ rá»‡t (2-3 thÃ¡ng) Ä‘á»ƒ phÃ¢n hÃ³a máº§m hoa.\r- Äáº¥t: Cáº§n táº§ng canh tÃ¡c dÃ y (trÃªn 1m), tÆ¡i xá»‘p, giÃ u há»¯u cÆ¡, thoÃ¡t nÆ°á»›c tá»‘t. Äá»™ pH lÃ½ tÆ°á»Ÿng 5.0 - 6.5.\r- CÃ  phÃª Arabica:\r- Äá»™ cao: Báº¯t buá»™c trá»“ng á»Ÿ Ä‘á»™ cao trÃªn 1000m (lÃ½ tÆ°á»Ÿng lÃ  1.200 - 1.800m) Ä‘á»ƒ phÃ¡t triá»ƒn hÆ°Æ¡ng vá»‹.\r- Nhiá»‡t Ä‘á»™: Æ¯a khÃ­ háº­u mÃ¡t máº», nhiá»‡t Ä‘á»™ trung bÃ¬nh 18-22Â°C. Nhiá»‡t Ä‘á»™ cao lÃ m quáº£ chÃ­n nhanh, tÃ­ch lÅ©y Ä‘Æ°á»ng kÃ©m, giáº£m cháº¥t lÆ°á»£ng.\r- LÆ°á»£ng mÆ°a: Cáº§n 1.200 - 2.000 mm/nÄƒm, phÃ¢n bá»‘ Ä‘á»u, khÃ´ng cáº§n mÃ¹a khÃ´ rÃµ rá»‡t nhÆ° Robusta.\r- Äáº¥t: TÆ°Æ¡ng tá»± Robusta nhÆ°ng yÃªu cáº§u kháº¯t khe hÆ¡n vá» hÃ m lÆ°á»£ng mÃ¹n vÃ  Ä‘á»™ tÆ¡i xá»‘p.',
api:dev:     metadata: {
api:dev:       has_bold: false,
api:dev:       has_list: true,
api:dev:       char_count: 810,
api:dev:       word_count: 169
api:dev:     },
api:dev:     rank: 1.71875,
api:dev:     headline: '<b>hoa</b>.\r- Äáº¥t: Cáº§n táº§ng canh tÃ¡c dÃ y (trÃªn 1m), tÆ¡i xá»‘p, giÃ u há»¯u cÆ¡, thoÃ¡t nÆ°á»›c tá»‘t. Äá»™ pH lÃ½ tÆ°á»Ÿng 5.0 - 6.5.\r- CÃ  phÃª'
api:dev:   },
api:dev:   {
api:dev:     chunkId: 'ca_phe_005',
api:dev:     loaiCay: 'CÃ  PhÃª',
api:dev:     chuDeLon: '2. CÃ¡ch trá»“ng',
api:dev:     tieuDeChunk: '2.2. Thá»i vá»¥ vÃ  Máº­t Ä‘á»™',
api:dev:     noiDung: '- Thá»i vá»¥: Trá»“ng vÃ o Ä‘áº§u mÃ¹a mÆ°a (thÃ¡ng 5 - 7) Ä‘á»ƒ táº­n dá»¥ng nÆ°á»›c trá»i, giÃºp cÃ¢y nhanh bÃ©n rá»… vÃ  phá»¥c há»“i.\r- Máº­t Ä‘á»™:\r- Robusta: Khoáº£ng cÃ¡ch 3m x 3m (1.100 cÃ¢y/ha) hoáº·c 3m x 2.5m (1.330 cÃ¢y/ha).\r- Arabica: ThÆ°á»ng trá»“ng dÃ y hÆ¡n Robusta, khoáº£ng cÃ¡ch 2.5m x 1.5m (2.660 cÃ¢y/ha) hoáº·c 3m x 1m (3.300 cÃ¢y/ha), tÃ¹y thuá»™c vÃ o giá»‘ng vÃ  ká»¹ thuáº­t táº¡o tÃ¡n.',
api:dev:     metadata: {
api:dev:       has_bold: false,
api:dev:       has_list: true,
api:dev:       char_count: 352,
api:dev:       word_count: 72
api:dev:     },
api:dev:     rank: 1.6935484,
api:dev:     headline: '- Thá»i vá»¥: Trá»“ng vÃ o Ä‘áº§u mÃ¹a mÆ°a (thÃ¡ng 5 - 7) Ä‘á»ƒ táº­n dá»¥ng nÆ°á»›c trá»i, giÃºp cÃ¢y nhanh bÃ©n rá»… vÃ  phá»¥c há»“i.\r- Máº­t Ä‘á»™'
api:dev:   }
api:dev: ]
api:dev: ==========================================================
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [CropKnowledgeFTSService] FTS returned 5 results
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [CropKnowledgeFTSService] ğŸ” extractDiseaseKeywords: query="mÆ°a nhiá»u liÃªn tá»¥c trong thá»i gian cÃ  phÃª ra hoa thÃ¬ nÃªn lÃ m gÃ¬" â†’ ascii="mua nhieu lien tuc trong thoi gian ca phe ra hoa thi nen lam gi"
api:dev: confidence cá»§a FTS:  1
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [CropKnowledgeFTSService] FTS top match: CÃ  PhÃª - 3.1. TÆ°á»›i nÆ°á»›c (rank: 1.7647, confidence: 1.000)
api:dev: threshold cá»§a FTS:  0.7
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [CropKnowledgeFTSService] ---------------------Layer 2 FTS match found (confidence: 1.000) in 24ms-----------------
api:dev: cropResult.found:  true
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM   DEBUG [ExactMatchV2Service] ğŸ” Search completed via crop_fts in 28ms - Found: true, Confidence: 1.000
api:dev: _orchestrator_ exactResult_layer1_FTS:  {
api:dev:   found: true,
api:dev:   content: '**CÃ  PhÃª - 3.1. TÆ°á»›i nÆ°á»›c**\n' +
api:dev:     '*Chá»§ Ä‘á»: 3. CÃ¡ch chÄƒm sÃ³c*\n' +
api:dev:     '\n' +
api:dev:     'ÄÃ¢y lÃ  ká»¹ thuáº­t quan trá»ng nháº¥t á»Ÿ TÃ¢y NguyÃªn (vÃ¹ng trá»“ng Robusta).\r- MÃ¹a khÃ´: Cáº§n tÆ°á»›i 3-4 Ä‘á»£t, má»—i Ä‘á»£t cÃ¡ch nhau 20-30 ngÃ y. LÆ°á»£ng nÆ°á»›c 400-600 lÃ­t/gá»‘c/láº§n tÆ°á»›i, Ä‘áº£m báº£o Ä‘áº¥t áº©m sÃ¢u 50-70cm.\r- Siáº¿t nÆ°á»›c: Cáº§n má»™t giai Ä‘oáº¡n khÃ´ háº¡n (siáº¿t nÆ°á»›c) 2-3 thÃ¡ng cuá»‘i mÃ¹a khÃ´ Ä‘á»ƒ cÃ¢y phÃ¢n hÃ³a máº§m hoa.\r- TÆ°á»›i ra hoa: Äá»£t tÆ°á»›i Ä‘áº§u tiÃªn sau mÃ¹a khÃ´ (thÆ°á»ng vÃ o thÃ¡ng 1-2) lÃ  quan trá»ng nháº¥t, mang tÃ­nh quyáº¿t Ä‘á»‹nh Ä‘á»ƒ hoa ná»Ÿ Ä‘á»“ng loáº¡t, tá»· lá»‡ Ä‘áº­u quáº£ cao. TÆ°á»›i muá»™n hoáº·c khÃ´ng Ä‘á»§ nÆ°á»›c sáº½ lÃ m hoa ná»Ÿ lÃ¡c Ä‘Ã¡c, hoa chanh (hoa khÃ´ng thá»¥ pháº¥n), nÄƒng suáº¥t giáº£m.',
api:dev:   source: { documentId: 'ca_phe_008', filename: 'CÃ  PhÃª.md', chunkIndex: 0 },
api:dev:   confidence: 1,
api:dev:   metadata: {
api:dev:     loai_cay: 'CÃ  PhÃª',
api:dev:     chu_de_lon: '3. CÃ¡ch chÄƒm sÃ³c',
api:dev:     tieu_de_chunk: '3.1. TÆ°á»›i nÆ°á»›c',
api:dev:     rank: 1.7647059,
api:dev:     match_type: 'fts_match',
api:dev:     processingTime: 24
api:dev:   }
api:dev: }
api:dev: exactResult.confidence:  1
api:dev: [Nest] 27584  - 12/15/2025, 1:26:38 PM     LOG [AIOrchestrator] âœ“ Layer 1 (Exact Match) succeeded
api:dev: PROCESSING LAYER1
api:dev: ai_response:  {
api:dev:   success: true,
api:dev:   message: '**CÃ  PhÃª - 3.1. TÆ°á»›i nÆ°á»›c**\n' +
api:dev:     '*Chá»§ Ä‘á»: 3. CÃ¡ch chÄƒm sÃ³c*\n' +
api:dev:     '\n' +
api:dev:     'ÄÃ¢y lÃ  ká»¹ thuáº­t quan trá»ng nháº¥t á»Ÿ TÃ¢y NguyÃªn (vÃ¹ng trá»“ng Robusta).\r- MÃ¹a khÃ´: Cáº§n tÆ°á»›i 3-4 Ä‘á»£t, má»—i Ä‘á»£t cÃ¡ch nhau 20-30 ngÃ y. LÆ°á»£ng nÆ°á»›c 400-600 lÃ­t/gá»‘c/láº§n tÆ°á»›i, Ä‘áº£m báº£o Ä‘áº¥t áº©m sÃ¢u 50-70cm.\r- Siáº¿t nÆ°á»›c: Cáº§n má»™t giai Ä‘oáº¡n khÃ´ háº¡n (siáº¿t nÆ°á»›c) 2-3 thÃ¡ng cuá»‘i mÃ¹a khÃ´ Ä‘á»ƒ cÃ¢y phÃ¢n hÃ³a máº§m hoa.\r- TÆ°á»›i ra hoa: Äá»£t tÆ°á»›i Ä‘áº§u tiÃªn sau mÃ¹a khÃ´ (thÆ°á»ng vÃ o thÃ¡ng 1-2) lÃ  quan trá»ng nháº¥t, mang tÃ­nh quyáº¿t Ä‘á»‹nh Ä‘á»ƒ hoa ná»Ÿ Ä‘á»“ng loáº¡t, tá»· lá»‡ Ä‘áº­u quáº£ cao. TÆ°á»›i muá»™n hoáº·c khÃ´ng Ä‘á»§ nÆ°á»›c sáº½ lÃ m hoa ná»Ÿ lÃ¡c Ä‘Ã¡c, hoa chanh (hoa khÃ´ng thá»¥ pháº¥n), nÄƒng suáº¥t giáº£m.',
api:dev:   intent: 'knowledge_query',
api:dev:   processingLayer: 'layer_1_exact',
api:dev:   confidence: 1,
api:dev:   responseTime: 188,
api:dev:   exactMatch: {
api:dev:     found: true,
api:dev:     content: '**CÃ  PhÃª - 3.1. TÆ°á»›i nÆ°á»›c**\n' +
api:dev:       '*Chá»§ Ä‘á»: 3. CÃ¡ch chÄƒm sÃ³c*\n' +
api:dev:       '\n' +
api:dev:       'ÄÃ¢y lÃ  ká»¹ thuáº­t quan trá»ng nháº¥t á»Ÿ TÃ¢y NguyÃªn (vÃ¹ng trá»“ng Robusta).\r- MÃ¹a khÃ´: Cáº§n tÆ°á»›i 3-4 Ä‘á»£t, má»—i Ä‘á»£t cÃ¡ch nhau 20-30 ngÃ y. LÆ°á»£ng nÆ°á»›c 400-600 lÃ­t/gá»‘c/láº§n tÆ°á»›i, Ä‘áº£m báº£o Ä‘áº¥t áº©m sÃ¢u 50-70cm.\r- Siáº¿t nÆ°á»›c: Cáº§n má»™t giai Ä‘oáº¡n khÃ´ háº¡n (siáº¿t nÆ°á»›c) 2-3 thÃ¡ng cuá»‘i mÃ¹a khÃ´ Ä‘á»ƒ cÃ¢y phÃ¢n hÃ³a máº§m hoa.\r- TÆ°á»›i ra hoa: Äá»£t tÆ°á»›i Ä‘áº§u tiÃªn sau mÃ¹a khÃ´ (thÆ°á»ng vÃ o thÃ¡ng 1-2) lÃ  quan trá»ng nháº¥t, mang tÃ­nh quyáº¿t Ä‘á»‹nh Ä‘á»ƒ hoa ná»Ÿ Ä‘á»“ng loáº¡t, tá»· lá»‡ Ä‘áº­u quáº£ cao. TÆ°á»›i muá»™n hoáº·c khÃ´ng Ä‘á»§ nÆ°á»›c sáº½ lÃ m hoa ná»Ÿ lÃ¡c Ä‘Ã¡c, hoa chanh (hoa khÃ´ng thá»¥ pháº¥n), nÄƒng suáº¥t giáº£m.',
api:dev:     source: { documentId: 'ca_phe_008', filename: 'CÃ  PhÃª.md', chunkIndex: 0 },
api:dev:     confidence: 1,
api:dev:     metadata: {
api:dev:       loai_cay: 'CÃ  PhÃª',
api:dev:       chu_de_lon: '3. CÃ¡ch chÄƒm sÃ³c',
api:dev:       tieu_de_chunk: '3.1. TÆ°á»›i nÆ°á»›c',
api:dev:       rank: 1.7647059,
api:dev:       match_type: 'fts_match',
api:dev:       processingTime: 24
api:dev:     }
api:dev:   },
api:dev:   sources: [ { type: 'document', reference: 'CÃ  PhÃª.md', confidence: 1 } ]
api:dev: }